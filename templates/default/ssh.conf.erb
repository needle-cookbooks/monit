# managed by chef, changes will be overwritten
check process sshd with pidfile /var/run/sshd.pid
  start program "/usr/sbin/service ssh start"
  stop program "/usr/sbin/service ssh stop"
  # under load a check may fail intermittently, so give it a few tries before restarting
  if failed port 22 protocol ssh 4 times within 6 cycles then restart
<%- if node.recipes.include?('monit::pagerduty') -%>
  if 5 restarts within 5 cycles
    then exec "/etc/monit/pagerduty-trigger ssh"
  else if passed for 3 cycles
    then exec "/etc/monit/pagerduty-resolve ssh"
<%- end -%>